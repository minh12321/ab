<div class="cart-container">
    <h1 class="cart-title">GIỎ HÀNG</h1>

        <!-- gio-hang.component.html -->
    <div *ngIf="product.length > 0; else noProducts">
      <h2>Giỏ hàng của bạn</h2>
      <table>
        <thead>
          <tr>
            <th>mã</th>
            <th>Tên sản phẩm</th>
            <th>Giá</th>
            <th>Số lượng</th>
            <th>Tổng tiền</th>
            <th></th>
            <th></th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let item of product">
            <td>{{ item.productCode }}</td>
            <td>{{ item.productName }}</td>
            <td>{{ item.totalPrice | currency }}</td>
            <td>{{ item.quantity }}</td>
            <td>{{ item.totalPrice * item.quantity | currency }}</td>
            <td><button (click)="delettespincart(item.productCode)" style="padding: 5px 10px; border: none; background: #f44336; color: white; border-radius: 4px;">Xóa</button></td>
            <td><button (click)="selectProduct(item.productCode)" [routerLink]="['/product']">Thông tin sp</button></td>
          </tr>
        </tbody>
      </table>
    </div>

    <ng-template #noProducts>
      <p>Giỏ hàng của bạn chưa có sản phẩm nào.</p>
    </ng-template>
    
    <div class="cart-summary">
      <h2 class="summary-title">TỔNG TIỀN</h2>
      <hr class="divider" />
      <div class="total">
        <span>Tổng: </span>
        <span class="total-amount">{{ totalAmount | currency:'VND' }}</span>
      </div>
      <button class="confirm-button" (click)="showPopup = true">
        <span>✔ Chốt đơn</span>
      </button>
    </div>
  </div>
  <!-- //---------------------------------------- -->
  <button (click)="toggleList()">Lịch sử giao dịch</button>

  <ul *ngIf="showList" class="popup-list">
    <li *ngFor="let item of hoadon" class="invoice-item">
      <div><strong>Mã đơn:</strong> {{ item.maHoaDon }}</div>
      <div><strong>Tên sản phẩm:</strong> {{ item.tenHang }}</div>
      <div><strong>Giá:</strong> {{ item.gia | currency:'VND' }}</div>
      <div><strong>Số lượng:</strong> {{ item.soLuong }}</div>
      <div><strong>Ngày mua:</strong> {{ item.ngayMua }}</div>
      <div><strong>Trạng thái:</strong> 
        <span [ngClass]="{
          'status-pending': item.trangThai === 'Chờ xác nhận',
          'status-success': item.trangThai === 'Đã thanh toán',
          'status-cancelled': item.trangThai === 'Đã giao'
        }">
          {{ item.trangThai }}
        </span>
      </div>
    </li>
  </ul>

  <app-thanh-toan-popup *ngIf="showPopup" (closePopup)="showPopup = false"></app-thanh-toan-popup>